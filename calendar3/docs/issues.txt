Issues:

--------------------------------------------------------------------------
Calendars, categories and filters.

Probably need to split this out from filters. Categories are a basic feature of
the RFC and we also need to be able to forumlate queries involving them, e.g

select events where <in-specific-calendars> and <some other conditions>

--------------------------------------------------------------------------
Durations
Specifying an event as a start+duration is part of the RFC. While this can
be converted to start+end this may pose problems with synch - the event may
still look changed to other devices.

Should probably have a duration column added.

---------------------------------------------------------------------------
Need to deal with this

edu.rpi.cct.webdav.servlet.shared.WebdavIntfException: edu.washington.cac.calfacade.shared.CalFacadeException: java.net.URISyntaxException: Illegal character in scheme name at index 0:  http://www.arts.rpi.edu/viewevents.php?cID=100
	at edu.rpi.cct.uwcal.caldav.CaldavComponentNode.init(CaldavComponentNode.java:141)
	at edu.rpi.cct.webdav.servlet.shared.WebdavNsNode.getUri(WebdavNsNode.java:140)
	at edu.rpi.cct.webdav.servlet.common.PropFindMethod.addHref(PropFindMethod.java:397)
	at edu.rpi.cct.webdav.servlet.common.PropFindMethod.doNodeProperties(PropFindMethod.java:215)
	at edu.rpi.cct.uwcal.caldav.ReportMethod.doNode(ReportMethod.java:349)
	at edu.rpi.cct.uwcal.caldav.ReportMethod.processResp(ReportMethod.java:327)
	at edu.rpi.cct.uwcal.caldav.ReportMethod.doMethod(ReportMethod.java:106)
	at edu.rpi.cct.webdav.servlet.common.WebdavServlet.service(WebdavServlet.java:119)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:237)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:157)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:214)
	at org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:104)
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:520)
	at org.apache.catalina.core.StandardContextValve.invokeInternal(StandardContextValve.java:198)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:152)
	at org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:104)
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:520)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:137)
	at org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:104)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:118)
	at org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:102)
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:520)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
	at org.apache.catalina.core.StandardValveContext.invokeNext(StandardValveContext.java:104)
	at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:520)
	at org.apache.catalina.core.ContainerBase.invoke(ContainerBase.java:929)
	at org.apache.coyote.tomcat5.CoyoteAdapter.service(CoyoteAdapter.java:160)
	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:799)
	at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnection(Http11Protocol.java:705)
	at org.apache.tomcat.util.net.TcpWorkerThread.runIt(PoolTcpEndpoint.java:577)
	at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:683)
	at java.lang.Thread.run(Thread.java:534)
Caused by: edu.washington.cac.calfacade.shared.CalFacadeException: java.net.URISyntaxException: Illegal character in scheme name at index 0:  http://www.arts.rpi.edu/viewevents.php?cID=100
	at edu.rpi.cct.uwcal.icalendar.IcalTranslator.toIcalEvent(IcalTranslator.java:305)
	at edu.rpi.cct.uwcal.caldav.CaldavComponentNode.init(CaldavComponentNode.java:127)
	... 32 more
Caused by: java.net.URISyntaxException: Illegal character in scheme name at index 0:  http://www.arts.rpi.edu/viewevents.php?cID=100
	at java.net.URI$Parser.fail(URI.java:2752)
	at java.net.URI$Parser.checkChars(URI.java:2925)
	at java.net.URI$Parser.checkChar(URI.java:2935)
	at java.net.URI$Parser.parse(URI.java:2951)
	at java.net.URI.<init>(URI.java:574)
	at edu.rpi.cct.uwcal.icalendar.IcalTranslator.toIcalEvent(IcalTranslator.java:300)
	... 33 more

------------------------------------------------------------------------------
locale stuff is still wrong.

default locale should be "default"

lang + country code might be set explicitly by browser but should always fall
back to default.

Change code:
  private static final String localeInfoDefault;
  private static final Locale localeDefault = Locale.getDefault();
  private static final String langDefault;
  private static final String countryDefault;

  static {
    langDefault = localeDefault.getLanguage();
    countryDefault = localeDefault.getCountry();

    localeInfoDefault = makeLocale(langDefault, countryDefault);
  }

to
  private static final String localeInfoDefault = "default";

  and make other appropriate changes
------------------------------------------------------------------------------


