<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">
<!--
 * Copyright 2004 Acegi Technology Pty Limited
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 *
 * $Id: acegisecurity-cas.xml,v 1.1 2004/11/15 18:31:31 rpical Exp $
-->

<beans>

  <bean id="serviceProperties" class="net.sf.acegisecurity.ui.cas.ServiceProperties">
    <property name="service"><value>https://app.web.server.rpi.edu:8443/cas/j_acegi_cas_security_check</value></property>
    <property name="sendRenew"><value>false</value></property>
  </bean>

  <bean id="casProcessingFilter" class="net.sf.acegisecurity.ui.cas.CasProcessingFilter">
    <property name="authenticationManager"><ref bean="authenticationManager"/></property>
    <property name="authenticationFailureUrl"><value>/casfailed.jsp</value></property>
    <property name="defaultTargetUrl"><value>/</value></property>
    <property name="filterProcessesUrl"><value>/j_acegi_cas_security_check</value></property>
  </bean>

  <bean id="securityEnforcementFilter" class="net.sf.acegisecurity.intercept.web.SecurityEnforcementFilter">
    <property name="filterSecurityInterceptor"><ref bean="filterInvocationInterceptor"/></property>
    <property name="authenticationEntryPoint"><ref bean="casProcessingFilterEntryPoint"/></property>
  </bean>

  <bean id="casProcessingFilterEntryPoint" class="net.sf.acegisecurity.ui.cas.CasProcessingFilterEntryPoint">
    <property name="loginUrl"><value>https://app.web.server.rpi.edu:8443/cas/login</value></property>
    <property name="serviceProperties"><ref bean="serviceProperties"/></property>
  </bean>
	<!-- Data access object which stores authentication information -->
	<bean id="inMemoryDaoImpl" class="net.sf.acegisecurity.providers.dao.memory.InMemoryDaoImpl">
  		<property name="userMap">
			<value>
				caluser1=uwcalx,demo.user
				caluser2=uwcalx,demo.user
				caluser3=uwcalx,demo.user
				calowner=uwcalx,demo.owner
				calowner2=uwcalx,demo.owner
				calowner3=uwcalx,demo.owner
				calcontent=uwcalx,demo.contentadmin
				caladmin=uwcalx,demo.admin
			</value>
		</property>
	</bean>

	<!-- Authentication provider that queries our data access object  -->
	<bean id="daoAuthenticationProvider" class="net.sf.acegisecurity.providers.dao.DaoAuthenticationProvider">
     	<property name="authenticationDao"><ref bean="inMemoryDaoImpl"/></property>
     	<property name="forcePrincipalAsString"><value>true</value></property>
	</bean>

	<!-- The authentication manager that iterates through our only authentication provider -->
	<bean id="authenticationManager" class="net.sf.acegisecurity.providers.ProviderManager">
		<property name="providers">
		  <list>
		    <ref bean="daoAuthenticationProvider"/>
		  </list>
		</property>
	</bean>

</beans>
