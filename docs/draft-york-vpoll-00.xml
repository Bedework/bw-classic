<?xml version="1.0" encoding="US-ASCII"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!ENTITY RFC2119 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC2434 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2434.xml">
<!ENTITY RFC3688 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3688.xml">
<!ENTITY RFC3986 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3986.xml">
<!ENTITY RFC4589 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4589.xml">
<!ENTITY RFC5545 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5545.xml">
<!ENTITY RFC5546 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5546.xml">
<!ENTITY RFC6047 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.6047.xml">
<!ENTITY I-D.daboo-icalendar-extensions SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.daboo-icalendar-extensions.xml">
<!ENTITY W3C.REC-xml-20060816 SYSTEM "http://xml.resource.org/public/rfc/bibxml4/reference.W3C.REC-xml-20060816.xml">
]>
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
<?rfc strict="yes" ?>
<?rfc toc="yes"?>
<?rfc tocdepth="5"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes" ?>
<?rfc compact="yes" ?>
<?rfc subcompact="no" ?>
<rfc category="std" docName="draft-york-vpoll-00" ipr="trust200902">

  <front>
    <title abbrev="Event Publishing Extensions to Icalendar">Event Publishing Extensions to Icalendar</title>

    <!-- add 'role="editor"' below for the editors if appropriate -->

    <author initials="E." surname="York" fullname="Eric York" role="editor">
      <organization abbrev="Apple Inc.">
        Apple Inc.
      </organization>
      <address>
        <postal>
          <street>1 Infinite Loop</street>
          <city>Cupertino</city>
          <region>CA</region>
          <code>95014</code> 
          <country>USA</country>
        </postal>
        <email>eyork@apple.com</email>
        <uri>http://www.apple.com/</uri>
      </address>
    </author>

    <author initials="C." surname="Daboo" fullname="Cyrus Daboo" role="editor">
      <organization abbrev="Apple Inc.">
        Apple Inc.
      </organization>
      <address>
        <postal>
          <street>1 Infinite Loop</street>
          <city>Cupertino</city>
          <region>CA</region>
          <code>95014</code> 
          <country>USA</country>
        </postal>
        <email>cyrus@daboo.name</email>
        <uri>http://www.apple.com/</uri>
      </address>
    </author>

    <author initials="M." surname="Douglass" fullname="Michael Douglass" role="editor">
      <organization abbrev="RPI">Rensselaer Polytechnic Institute</organization>
      <address>
        <postal>
          <street>110 8th Street</street>
          <city>Troy</city>
          <region>NY</region>
          <code>12180</code>
          <country>USA</country>
        </postal>
        <email>douglm@rpi.edu</email>
        <uri>http://www.rpi.edu/</uri>
      </address>
    </author>

    <date month="November" year="2012"/>

    <area>Applications</area>

    <keyword>icalendar</keyword>

    <keyword>properties</keyword>

    <abstract>
      <t>
        This specification introduces a new iCalendar component which allows
        for consensus scheduling, that is voting on a number of alternative
        meeting or task alternatives.
      </t>
    </abstract>
  </front>

  <middle>
    <section title="Introduction">
      <t>
        The currently existing approach to agreeing on meeting times using iTip
        <xref target='RFC5546'/> and/or iMip <xref target='RFC6047'/> have some 
        significant failings. There is no useful bargaining or suggestion 
        mechanism in iTip, only the ability for a potential attendee to accept 
        or refuse or to counter with a time of their own choosing. 
      </t>

      <t>
        Part of the problem is that for many potential attendees, their freebusy
        is not an accurate representation of their avalability. In fact, when
        trying to schedule conference calls across different organizations, 
        attendees may not be allowed to provide freebusy information or 
        availability as this may reveal something of the organizations internal
        activities. 
      </t>

      <t>
        A number of studies have shown that large amounts of time are spent 
        trying to come to an agreement - up to and beyond 20 working hours 
        per meeting. many organizers fall back on other approachessuch as 
        phone calls and email to determine a suitable time.
      </t>

      <t>
        Online services have appeared as a result and these allow participants 
        to vote on a number of alternatives without revealing or using freebusy
        or availability.
        When agreement is reached a conventional scheduling message may be sent
        to the attendees. This approach appears to reach consensus fairly rapidly. 
        Peer pressure may have some bearing on this as all voters are able to 
        see the current state of the voting and may adjust their own meeting 
        schedules to make themselves available for a popular choice. 
      </t>

      <t>
        The component and properties defined in this specification provide a
        standardized structure to this process and allow calendar clients and 
        servers and these web based services to interact.
      </t>

      <t>
        These structures also have uses beyond the relatively simple needs of most
        meeting organizers. The process of coming to consensus can also be viewed 
        as a bidding process. 
      </t>
    </section>

    <section anchor="conventions" 
             title='Conventions and Terms Used in This Document'>
      <t>
        The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
        NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
        "MAY", and "OPTIONAL" in this document are to be interpreted as
        described in <xref target='RFC2119'/>.
      </t>
      
      <t>
        Additionally we will use the following terms:
        
        <list style='hanging'>
          <t hangText="Consensus Scheduling:">
            The process whereby we come to some agreement on meeting or task
            alternatives and then book that meeting or task.
          </t>

          <t hangText="Voter:">
            A participant who votes on th ealternatives. A voter need not be
            an attendee of any of the alternatives presented.
          </t>
        </list>
      </t>
    </section>

    <section anchor="simple-consensus_scheduling" 
             title="Simple Consensus Scheduling">
      <t>
        This specification defines components and properties which can be used
        for simple consensus scheduling but also have the generality to handle
        more complex cases. To provide an easy (and for many - sufficient) 
        introduction to consensus scheduling and VPOLL we will outline the 
        flow of information for the simple case of voting on a number of 
        meeting alternatives which differ only in time. In addition the voters
        will all be potential attendees.
      </t>

      <t>
        This specification not only defines data structures but adds a new iTip
        method used when consensus has been reached. we will show how a VPOLL
        object is used to inform voters of the state of a simple vote on
        some alternatives.
      </t>

      <section anchor="vpoll_component_overview" 
             title="The VPOLL Component: An Overview">
        <t>
          The VPOLL component acts as a wrapper for a number of alternatives to
          be voted on together with some properties used to maintain the state
          of the voting. For our simple example the following VPOLL properties
          and sub-components are either required or appropriate: 
        
          <list style='hanging'>
            <t hangText="DTSTAMP:">
              The usual <xref target='RFC5545'/> property.
            </t>
              
            <t hangText="SEQUENCE:">
              The usual <xref target='RFC5545'/> property. See below for SEQUENCE
              behavior.
            </t>
  
            <t hangText="UID:">
              The usual <xref target='RFC5545'/> property.
            </t>
            
            <t hangText="ORGANIZER:">
              The usual <xref target='RFC5545'/> property. In general this need not 
              be an organizer of any of the alternatives. In this simple outline
              we assume it is the same.
            </t>
  
            <t hangText="SUMMARY:">
              The usual <xref target='RFC5545'/> property. This optional but
              recommended property provides the a short title to the poll.
            </t>
  
            <t hangText="DESCRIPTION:">
              The usual <xref target='RFC5545'/> property. This optional property
              provides more details.
            </t>
  
            <t hangText="DTEND:">
              The usual <xref target='RFC5545'/> property. This optional property
              provides a poll closing time and date.
            </t>
  
            <t hangText="POLL-MODE:">
              A new property which defines how the votes are used to obtain a 
              result. For our use case it will take the value "BASIC" meaning 
              one event will be chosen from the alternatives. 
            </t>
  
            <t hangText="VOTER:">
              A new property. There is one of these for each voter and it is 
              similar to the <xref target='RFC5545'/> ATTENDEE property. In the 
              VPOLL component it shows who takes part in the voting. 
            </t>
  
            <t hangText="VEVENT:">
              In our simple use case there will be multiple VEVENT sub-components
              defining the alternatives. Each will have  adifferent date and or time
              for the meeting. 
            </t>
          </list>
        </t>

        <t>
          Putting that together we can construct an example VPOLL with 3 voters
          and 3 alternative meetings:
          
          <figure>
            <artwork><![CDATA[
       BEGIN:VCALENDAR
       VERSION:2.0
       PRODID:-//Example//Example
       METHOD:REQUEST
       BEGIN:VPOLL
       POLL-MODE: BASIC
       ORGANIZER:mailto:mike@example.com
       UID:sched01-1234567890
       DTSTAMP:20120101T000000Z
       SUMMARY:What to do this week
       DTEND:20120101T000000Z
       VOTER:mailto:cyrus@exmaple.com
       VOTER:mailto:eric@example.com
       VEVENT.......(with a poll-item-id=1)
       VEVENT.......(with a poll-item-id=2)
       VEVENT.......(with a poll-item-id=3)
       END:VPOLL
       END:VCALENDAR
]]></artwork>
          </figure>
        </t>
        
        <t>
          As can be seen in the example above, there is an iTip METHOD property
          with the value REQUEST. The VPOLL object will be distributed to all
          the voters, either through iMipor through some VPOLL enabled service. 
        </t>
      </section>

      <section anchor="vpoll_subcomponent_overview" 
             title="The VPOLL Subcomponents: An Overview">
        <t>
          Within the VPOLL component we have the alternatives to vote on. In many
          respects these are standard <xref target='RFC5545'/> components. For 
          our simple use case they are all VEVENT components. In addition to the
          usual <xref target='RFC5545'/> properties some extra properties are 
          used for a VPOLL.
        
          <list style='hanging'>
            <t hangText="POLL-ITEM-ID:">
              This provides a unique reference to the sub-component within the
              VPOLL. It's value SHOULD be a small integer. 
            </t>
          
            <t hangText="VOTER:">
              The VOTER property within a VPOLL sub-component specifies the
              state of the vote for that voter. The RESPONSE parameter supplies 
              the current vote in the range 0 to 100. For many purposes this is 
              too fine grained and recommended values are defined for voting
              preferences of "NO", "MAYBE" and "YES" with an additional 
              "YES but not the preferred outcome". These properties will be 
              added to the sub-components as responses appear.
            </t>
          </list>
        </t>
      </section>
      
      <section anchor="vpoll_responses" 
             title="VPOLL responses">
        <t>
          Upon receipt of a VPOLL REQUEST the voter will reply with a VPOLL
          component containing their vote. In our simple case it will have the 
          following properties:
        
          <list style='hanging'>
            <t hangText="DTSTAMP:">
              The usual <xref target='RFC5545'/> property.
            </t>
              
            <t hangText="SEQUENCE:">
              The usual <xref target='RFC5545'/> property. See below for SEQUENCE
              behavior.
            </t>
  
            <t hangText="UID:">
              Same as the request.
            </t>
  
            <t hangText="ORGANIZER:">
              Same as the request.
            </t>
  
            <t hangText="SUMMARY:">
              Same as the request.
            </t>
  
            <t hangText="VOTER:">
              One only - the voter replying. 
            </t>
  
            <t hangText="POLL-ITEM-ID:">
              One per item being voted on. There does not need to be one for
              each sub-component but each REPLY will set the voting state for
              every sub-component.
            </t>
          </list>
        </t>
        
        <t>
          Note that a voter can send a number of REPLYs for each REQUEST sent
          by the organizer. Each REPLY completely replaces the voting record for
          that voter for all components being voted on. In our example, if Eric
          respondes and votre for items 1 and 2 and then responds again with a 
          vote for only item 3 the final outcome is one vote on item 3.
        </t>

        <t>
          Putting this together we can construct an example REPLY VPOLL from 
          cyrus:
          
          <figure>
            <artwork><![CDATA[
       BEGIN:VCALENDAR
       VERSION:2.0
       PRODID:-//Example//Example
       METHOD: REPLY
       BEGIN:VPOLL
       ORGANIZER:mailto:douglm@example.com
       VOTER:mailto:cyrus@example.com
       UID:sched01-1234567890
       DTSTAMP:20120101T010000Z
       SUMMARY:What to do this week
       POLL-ITEM-ID;RESPONSE=50;PUBLIC-COMMENT=Work on iTIP:1
       POLL-ITEM-ID;RESPONSE=100;COMMENT=Work on WebDAV:2
       POLL-ITEM-ID;RESPONSE=0:3
       END:VPOLL
       END:VCALENDAR
]]></artwork>
          </figure>
        </t>
      </section>
      
      <section anchor="vpoll_updates" 
             title="VPOLL updates">
        <t>
          When the organizer receives a response from one or more voters the
          current state of the poll is sent to all voters. The new iTip method
          POLLSTATUS is used. The VPOLL can contain a reduced set of properties
          but MUST contain DTSTAMP, SEQUNCE (if not 0), UID, ORGANIZER and VOTER.
        </t>

        <t>
          In additon, for out use case, it will contain skeleton VEVENT 
          sub-components with the POLL-ITEM-ID and VOTER properties. Clients 
          receiving this poll status SHOULD merge it in to their own copy to give
          the full current status
        </t>

        <t>
          An example:
          
          <figure>
            <artwork><![CDATA[
       BEGIN:VCALENDAR
       VERSION:2.0
       PRODID:-//Example//Example
       METHOD: POLLSTATUS
       BEGIN:VPOLL
       ORGANIZER:mailto:douglm@example.com
       VOTER:mailto:cyrus@example.com
       VOTER:mailto:eric@example.com
       UID:sched01-1234567890
       DTSTAMP:20120101T020000Z
       SEQUENCE:0
       SUMMARY:What to do this week
       BEGIN:VEVENT
       POLL-ITEM-ID: 1
       VOTER;RESPONSE=50;COMMENT=Work on iTIP:
        mailto:cyrus@exmaple.com
       VOTER;RESPONSE=100:mailto:eric@example.com
       END:VEVENT
       BEGIN:VEVENT
       POLL-ITEM-ID: 2
       VOTER;RESPONSE=100;COMMENT=Work on WebDAV:
        mailto:cyrus@exmaple.com
       VOTER;RESPONSE=100:mailto:eric@example.com
       END:VEVENT
       BEGIN:VEVENT
       POLL-ITEM-ID: 3
       VOTER;RESPONSE=0:mailto:cyrus@example.com
       VOTER;RESPONSE=0:mailto:eric@example.com
       END:VEVENT
       END:VPOLL
       END:VCALENDAR
]]></artwork>
          </figure>
        </t>
      </section>
      
      <section anchor="vpoll_completion" 
             title="VPOLL Completion">
        <t>
          After a number of REPLY messages have been received the poll will be 
          considered complete. If there is a DTEND on the poll the system may
          automatically close the poll, or the organizer may, at any time, 
          consider the poll complete.
        </t>
        
        <t>
          The poll is completed by sending a final iTip message with the new
          CONFIRM method. In this case the VPOLL component contains ...
        </t>

        <t>
          The VPOLL conformation example:
          
          <figure>
            <artwork><![CDATA[
       BEGIN:VCALENDAR
       VERSION:2.0
       PRODID:-//Example//Example
       METHOD: CONFIRM
       BEGIN:VPOLL
       ORGANIZER:mailto:douglm@example.com 
       UID:sched01-1234567890
       DTSTAMP:20120101T030000Z
       SEQUENCE:0
       SUMMARY:What to do this week
       BEGIN:VEVENT
       UID:123
       ......
       END:VEVENT
]]></artwork>
          </figure>
        </t>
      </section>
    </section>
               
    <section anchor="icalendar_extensions"
             title="iCalendar Extensions">
      <section anchor="new_property_parameters"
               title="New Property Parameters">
        <section anchor="parameter_public_comment"
                 title="Public-Comment">
          <t>
            <list style='hanging'>
              <t hangText="Parameter name:">
                PUBLIC-COMMENT
              </t>
    
              <t hangText="Purpose:">
                To allow voters to provide a public comment in their reponse.
              </t>
    
              <t hangText="Format Definition:">
                <figure>
                  <preamble>
                    This parameter is defined by the following notation:
                  </preamble>
    
                  <artwork type="abnf">
   public-comment-param = "PUBLIC-COMMENT=" DQUOTE text DQUOTE
                  </artwork>
                </figure>
              </t>
    
              <t hangText="Description:">
                This parameter can be specified on the POLL-ITEM-ID property to 
                allow a voter to add some commentary visible to all voters. 
              </t>
            </list>
          </t>
        </section>
         
        <section anchor="parameter_response"
                 title="Response">
          <t>
            <list style='hanging'>
              <t hangText="Parameter name:">
                RESPONSE
              </t>
    
              <t hangText="Purpose:">
                To specify a response vote.
              </t>
    
              <t hangText="Format Definition:">
                <figure>
                  <preamble>
                    This parameter is defined by the following notation:
                  </preamble>
    
                  <artwork type="abnf">
    response-param = "RESPONSE=" integer
          ; integer value 0..100
                  </artwork>
                </figure>
              </t>
    
              <t hangText="Description:">
                This parameter can be specified on the POLL-ITEM-ID property to 
                provide the value of the voters response. This parameter allows
                for fine grained responses which are appropriate to some 
                applications. For the case of individuals voting for a choice of
                events client applications SHOULD conform to the following
                convention:
                <list style='symbols'>
                  <t>
                    0 - 39 A "NO vote".
                  </t>
                  <t>
                    40 - 79 A "MAYBE" vote
                  </t>
                  <t>
                    80 - 89 A "YES - but not preferred vote"
                  </t>
                  <t>
                    90-100 A "YES" vote.
                  </t>
                </list>
              </t>
            </list>
          </t>
        </section>
  
        <section anchor="parameter_stayinformed"
                 title="Stay-Informed">
          <t>
            <list style='hanging'>
              <t hangText="Parameter name:">
                STAY-INFORMED
              </t>
    
              <t hangText="Purpose:">
                To specify the voter also wants to be added as an ATTENDEE when 
                the poll is confirmed.
              </t>
    
              <t hangText="Format Definition:">
                <figure>
                  <preamble>
                    This parameter is defined by the following notation:
                  </preamble>
    
                  <artwork type="abnf">
    stayinformedparam = "STAY-INFORMED" "=" boolean
                  </artwork>
                </figure>
              </t>
    
              <t hangText="Description:">
                This parameter MAY be specified on VOTER and, if the value is TRUE,
                indicates the voter wishes to be added to the final choice as a 
                non participant.
              </t>
            </list>
          </t>
        </section>
      </section>
  
      <section anchor="new_properties"
               title="New Properties">
        <section anchor="accept_response"
                 title="Accept-Response">
          <t>
            <list style='hanging'>
              <t hangText="Property name:">
                ACCEPT-RESPONSE
              </t>
    
              <t hangText="Purpose:">
                This property is used in VPOLL to indicate the types of component
                that may be supplied in a response.
              </t>
    
              <t hangText="Property Parameters:">
                Non-standard or iana parameters can be specified on this property.
              </t>
    
              <t hangText="Conformance:">
                This property MAY be specified in a VPOLL component.
              </t>
    
              <t hangText="Description:">
                When used in a VPOLL this property indicates what allowable 
                component types may be returned in a reply. Typically this would
                allow a voter to respond with the freebusy or availability rather
                than choosing one of the presented alternatives
              </t>
    
              <t>
                If this property is not present voters are only allowed to 
                respond with the same component type as in the request.
              </t>
    
              <t hangText="Format Definition:">
                <figure>
                  <preamble>
                    This property is defined by the following notation:
                  </preamble>
    
                  <artwork type="abnf">
  acceptresponse = "ACCEPT-RESPONSE" "="    
                       acceptresponseparams ":"    
                       iana-token ("," iana-token) CRLF
                       
  acceptresponseparams = *(";" other-param)
                  </artwork>
                </figure>
              </t>
            </list>
          </t>
        </section>
        
        <section anchor="poll_item_id"
                 title="Poll-Item-Id">
          <t>
            <list style='hanging'>
              <t hangText="Property name:">
                POLL-ITEM-ID
              </t>
    
              <t hangText="Purpose:">
                This property is used in VPOLL to indicate recipients of the poll
                and in VPOLL sub-components to give the voters response.
              </t>
    
              <t hangText="Value type:">
                The value type for this property is param-value.
              </t>
    
              <t hangText="Property Parameters:">
                Non-standard, response, public-comment or stayinformed parameters 
                can be specified on this property.
              </t>
    
              <t hangText="Conformance:">
                This property MAY be specified in a VPOLL component or its 
                sub-components.
              </t>
    
              <t hangText="Description:">
                In a METHOD:REQUEST each child component MUST have a POLL-ITEM-ID 
                property. Each set of components with the same POLL-ITEM-ID value 
                represents one overall set of items to be voted on.
              </t>
              
              <t>
                In a METHOD:REPLY there is a single VPOLL component which MUST have:
                either one or more POLL-ITEM-ID properties with a RESPONSE param 
                matching that from a REQUEST or a VFREEBUSY or VAVAILABILITY child 
                component showing overall busy/available time.
              </t>
    
              <t hangText="Format Definition:">
                <figure>
                  <preamble>
                    This property is defined by the following notation:
                  </preamble>
    
                  <artwork type="abnf">
          pollitemid = "POLL-ITEM-ID" pollitemdparams ":" 
                     param-value CRLF
          
          pollitemidparams = *(
                      (";" responseparam) /
                      (";" stayinformedparam) /
                      (";" public-comment-param) /
                      (";" other-param)
               )
              
                  </artwork>
                </figure>
              </t>
            </list>
          </t>
        </section>
        
        <section anchor="poll_mode"
                 title="Poll-Mode">
          <t>
            <list style='hanging'>
              <t hangText="Property name:">
                POLL-MODE
              </t>
    
              <t hangText="Purpose:">
                This property is used in VPOLL to indicate what voting mode is
                to be applied.
              </t>
    
              <t hangText="Property Parameters:">
                Non-standard or iana parameters 
                can be specified on this property.
              </t>
    
              <t hangText="Conformance:">
                This property MAY be specified in a VPOLL component or its 
                sub-components.
              </t>
    
              <t hangText="Description:">
                The poll mode defines how the votes are applied to obtain a result.
                BASIC mode, the default, means that the voters are selecting one 
                component (or group of components) with a given POLL=ITEM-ID.
              </t>
              
              <t>
                Other polling modes may be defined in updates to this specification.
                These may allow for such modes as ranking.
              </t>
    
              <t hangText="Format Definition:">
                <figure>
                  <preamble>
                    This property is defined by the following notation:
                  </preamble>
    
                  <artwork type="abnf">
          pollmode = "POLL-MODE" pollmodeparams ":" 
              ("BASIC" / iana-token / other-token) CRLF
          
          pollmodeparams = *(";" other-param)
              
                  </artwork>
                </figure>
              </t>
    
              <t hangText="Note">
                This property MUST be present in an iTip request. If the client
                does not understand the poll mode it should use the LINk [URL?]
                proeprty to get the web-based view of the poll.
              </t>
            </list>
          </t>
        </section>
        
        <section anchor="voter"
                 title="Voter">
          <t>
            <list style='hanging'>
              <t hangText="Property name:">
                VOTER
              </t>
    
              <t hangText="Purpose:">
                This property is used in VPOLL to indicate recipients of the poll
                and in VPOLL sub-components to give the voters response.
              </t>
    
              <t hangText="Value type:">
                The value type for this property is cal-address.
              </t>
    
              <t hangText="Property Parameters:">
                Non-standard, cutype, member, role, rsvp, delto, delfrom, sentby,
                cn, dir, lang, response or stayinformed parameters 
                can be specified on this property.
              </t>
    
              <t hangText="Conformance:">
                This property MAY be specified in a VPOLL component or its 
                sub-components.
              </t>
    
              <t hangText="Description:">
                When used in a VPOLL this property indicates who the poll is sent 
                to. When used in sub-components of VPOLL this property indicate 
                the response of each voter as known at that time.
              </t>
    
              <t hangText="Format Definition:">
                <figure>
                  <preamble>
                    This property is defined by the following notation:
                  </preamble>
    
                  <artwork type="abnf">
    voter = "VOTER" voterparams ":" cal-address CRLF
  
    voterparam   = *(
                    ;
                    ; The following are OPTIONAL,
                    ; but MUST NOT occur more than once.
                    ;
                    (";" cutypeparam) / (";" memberparam) /
                    (";" roleparam) /
                    (";" rsvpparam) / (";" deltoparam) /
                    (";" delfromparam) / (";" sentbyparam) /
                    (";" cnparam) / (";" dirparam) /
                    (";" languageparam) /
                    (";" responseparam) / 
                    (";" stayinformedparam) /
                    ;
                    ; The following is OPTIONAL,
                    ; and MAY occur more than once.
                    ;
                    (";" other-param)
                    ;
              )
              
                  </artwork>
                </figure>
              </t>
            </list>
          </t>
        </section>
      </section>
  
      <section anchor="new_vpoll_component"
               title="VPOLL Component">
      
        <t>
          <list style='hanging'>
            <t hangText="Component name:">
              VPOLL
            </t>
  
            <t hangText="Purpose:">
              This component provides a mechanism by which voters can vote on
              provided choices.
            </t>
  
            <t hangText="Format Definition:">
              <figure>
                <preamble>
                  This property is defined by the following notation:
                </preamble>
  
                <artwork type="abnf">
  pollc    = "BEGIN" ":" "VPOLL" CRLF
               pollprop 
               *eventc *todoc *journalc *freebusyc 
               *availabilityc *alarmc *iana-comp *x-comp
               "END" ":" "VPOLL" CRLF
               
  pollprop = *(
             ;
             ; The following are REQUIRED,
             ; but MUST NOT occur more than once.
             ;
             dtstamp / uid / organizer /
             ;
             ; The following are OPTIONAL,
             ; but MUST NOT occur more than once.
             ;
             acceptresponse / class / created / description /
             dtstart / last-mod / pollmode / priority /
             seq / status / summary /
             url /
             ; Either 'dtend' or 'duration' MAY appear in
             ; a 'pollprop', but 'dtend' and 'duration'
             ; MUST NOT occur in the same 'pollprop'.
             ; 'duration' MUST only occur when 'dtstart'
             ; is present
             ;
             dtend / duration /
             ;
             ; The following are OPTIONAL,
             ; and MAY occur more than once.
             ;
             attach / categories / comment /
             contact / link / pollitemid / pollwinner / 
             rstatus / related /
             resources / voter / x-prop / iana-prop
             ;
             )
               </artwork>
              </figure>
            </t>
  
            <t hangText="Description:">
              This component provides a mechanism by which voters can vote on
              provided choices. The outcome depends upon the POLL-MODE in effect.
            </t>
  
            <t>
              VOTER in VPOLL requests refers to each person who will be voting - 
              RSVP=TRUE is used by the organizer to force the voter to reset 
              their state and re-vote
            </t>
  
            <t>
              If specified, the "DTSTART" property defines the start or 
              opening of the poll. If absent the poll is presumed to have started
            </t>
  
            <t>
              If "DTSTART"is present "DURATION" MAY be specified and indicates
              the duration, and hence the ending, of the poll. 
            </t>
  
            <t>
              "DTEND" MAY be specified with or without "DTSTART" and indicates
              the ending of the poll. 
            </t>
          </list>
        </t>
      </section>      
    </section>
               
    <section anchor="itip_extensions"
             title="iTip Extensions">
      <t>
        This specification introduces two new METHOD values..
      </t>
      
      <t>
        This section to be completed: Current notes are: 
        <list style='symbols'>
          <t>
            In a METHOD:REQUEST each child component MUST have a POLL-ITEM-ID property. 
    Each set of components with the same POLL-ITEM-ID value represents one overall 
    set of items to be voted on.
          </t>
          
          <t>
            In a METHOD:REPLY there is a single VPOLL component which MUST have:
    either one or more POLL-ITEM-ID properties with a RESPONSE param matching 
    that from a REQUEST
    or a VFREEBUSY or VAVAILABILITY child component showing overall busy/available time.
          </t>
          
          <t>
            In a METHOD:REPLY the VPOLL MUST have one VOTER only
          </t>
          
          <t>
            In a METHOD:CONFIRM the VPOLL MUST have all the components from the chosen POLL-ITEM-ID set
          </t>
          
          <t>
            In a METHOD:CANCEL there is a single VPOLL component with UID matching that of the poll being cancelled.
          </t>
          
          <t>
            No ADD, COUNTER or DECLINE-COUNTER behavior defined
          </t>
          
          <t>
            In a METHOD:REFRESH organizer returns a METHOD:REQUEST with the current full state, or a METHOD:CANCEL, or a METHOD:CONFIRM, or an error if no matching poll is found.
          </t>
        </list>
      </t>
    </section>
    
    <section anchor="caldav_implications"
             title="CalDAV implications">
      <t>
        <list style='numbers'>
          <t>
       time range request for VPOLLs (need to define)
          </t>
            
          <t>
       How do outstanding VPOLLs affect freebusy requests?
            <vspace/>
         Transparency is client controlled - server/client implementations may provide defaults - ruled out TRANSP in VPOLL
            <vspace/>
         So freebusy handling is as standard
          </t>
            
          <t>
       VPOLLs live as resources in a calendar collection
          </t>
            
          <t>
       Book rooms right away? No impact on protocol - implementation detail only. 
          </t>
            
          <t>
       Implicit: when to send out a refresh to voters - implementation detail only
          </t>
            
          <t>
       TODO: On a collection that supports VPOLLs, define a property that contains VPOLL limits like the max number of poll items, max number of voters.
          </t>
            
          <t>
       How does the user know that need to take action on a server generated CANCELLED, CLOSED, CONFIRMED? ITIP or notification collection? Might be notification collection, a resource update notification.
          </t>        
        </list>
      </t>
    
      <section anchor="capabilities"
               title="Capabilities">
        <t>
          Ths suggests we need some way of determining server capabilities - 
          is this an extension to CalDAV? 
        </t>
        <t>
          Information returned in a capabil        pollwinner = "POLL-WINNER" pollwinnerparams ":" text CRLF
        pollwinnerparams = *(";" other-param)
        ; Used with a STATUS:CONFIRMED VPOLL to indicate which components have
        ; been confirmed
          ities object needs to include:
          <list style='numbers'>
            <t>
    List of poll modes
            </t>

            <t>
    List of supported components
            </t>

            <t>
    Combination of components
            </t>

            <t>
    Limits: 
            </t>

            <t>
    # of items, 
            </t>

            <t>
    # voters
            </t>

            <t>
    Size of individual resources
            </t>

            <t>
    Size of total vpoll
            </t>

            <t>
    # active polls
            </t>

            <t>
    Max voting period 
            </t>

            <t>
    itip/~itip
            </t>

            <t>
    remote attendee/voter capable
            </t>

            <t>
    poll options - e.g "vpoll-basic" 
            </t>
          </list>
        </t>
      </section>
    </section>

    <section anchor="Notes"
             title="Notes">
      <t>
        Various collected notes to be fitted in somewhere...
      </t>
      
      <t>
        <list style='numbers'>
          <t>
            What about POLL-WINNER?
            <figure>

              <artwork type="abnf">
        pollwinner = "POLL-WINNER" pollwinnerparams ":" text CRLF
        pollwinnerparams = *(";" other-param)
        ; Used with a STATUS:CONFIRMED VPOLL to indicate which 
        ; components have been confirmed
             </artwork>
            </figure>
          </t>
            
          <t>
            Need to add example of freebusy in response
            <figure>

              <artwork>
BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//BedeworkCaldavTest//BedeworkCaldavTest
METHOD: REPLY
BEGIN:VPOLL
ORGANIZER:mailto:douglm@mysite.edu
VOTER:mailto:eric@example.com
UID:sched01-1234567890
DTSTAMP:20120101T010000Z
SEQUENCE:0
SUMMARY:What to do this week
BEGIN:VFREEBUSY
.......
END:VFREEBUSY
END:VPOLL
END:VCALENDAR
             </artwork>
            </figure>
          </t>
            
          <t>
            Need to talk about what a change in SEQUENCE means
            <vspace/>
            Sequence change forces a revote. 
            <vspace/>
            New voter - no sequence change
            <vspace/>
            Add another poll set or change poll item ids or any change to a child 
            component - bump sequence
            
          </t>
            
          <t>
            VOTER in VPOLL request refers to each person who will be voting - RSVP=TRUE is used by the organizer to force the voter to reset their state and re-vote
          </t>
            
          <t>
            Then the VOTER property with a RESPONSE parameter can be in every child component to show each voters current response
          </t>
            
          <t>
            Updates from the Organizer to change voter states go out using a new METHOD that only requires a minimal representation for child components and only includes changed VOTER states
          </t>
            
          <t>
            If the Organizer does send out a full update (METHOD:REQUEST), then VOTER properties are included in the child components
          </t>
            
          <t>
            Need to describe the rules for POLL-MODE:BASIC
          </t>
            
          <t>
            Define LINK types - n
          </t>
            
          <t>
            Keep polls around after confirm or cancel. Use STATUS parameter inside VPOLL with states: NEEDS-ACTION, CANCELLED, CLOSED, CONFIRMED. Use POLL-ITEM-ID to identify the confirmed component.
          </t>
            
          <t>
            Confirm/cancel implies voting is closed.
          </t>
            
          <t>
            POLL-ITEM-ID  SHOULD be a unique ID. If it remains the same between REQUESTs then the  previous response for that component MAY be re-used. To force a re-vote on a component due to a significant change, the POLL-ITEM-ID MUST change.
          </t>
            
          <t>
            A good client will remember the DTSTAMP of each VOTER and not allow an older DTSTAMP to override a newer DTSTAMP.
          </t>
            
          <t>
            Fill out VOTER with the rest of the ATTENDEE properties (SCHEDULE-STATUS, SCHEDULE-AGENT)
          </t>
            
          <t>
            VALARMs are allowed in VPOLL and represent a per-user alarm for the VPOLL itself (must be removed in iTIP messages). Need to describe what a relative alarm is relative to.
          </t>
            
          <t>
            Use STATUS to mark active, canceled, completed. Update DTEND with the end time
          </t>
            
          <t>
            Client updates their VOTER property as in the POLLSTATUS example.
          </t>
            
          <t>
            Winning Non-scheduled VEVENTs or VTODOs will get an ORGANIZER property and a list of non-participating ATTENDEEs
          </t>
            
          <t>
            Clients must preserve the responseparam value when there is no change from thre user even if they have a UI with fixed states (e.g. yes/no/maybe)
          </t>
            
          <t>
            LINK or URL in POLL-MODE?
          </t>
            
          <t>
Use RELATED-TO in a icalendar component such as VEVENT or VTODO with a new reltypeparam to specify the relationship to a VPOLL. May need a reltypeparam for both an active and confirmed poll, or may only need one reltypeparam. Need to pick a new reltypeparam name.
          </t>
            
          <t>
Support a mask on what icalendar properties are being voted on, something like MASK: DTSTART, DTEND, SUMMARY. Other icalendar properties may be different like the ATTENDEE list but they won't be part of the vote in this example. Need to pick a icalendar property name for this mask. 
          </t>
            
          <t>
Like MASK, but for a caldav server, a dav property that specify what icalender properties this server supports for voting. 
          </t>
            
          <t>
For a caldav server, a compatibility dav property similar to support component sets which specifies what sets of icalendar components are supports for voting, for example, only support VEVENTs. 
          </t>
            
          <t>
Need to do a section on what Notifications to support.
            <vspace/>
        A. VPOLL is about to end and you haven't voted on it yet.
          </t>
            
          <t>
Need to pick: SCHEDULED-AGENT=NONE or STATUS:DRAFT or a non-calendar collection for drafts. Each one has it's pluses and minuses. 
          </t>
            
          <t>
What to do with changes to STATUS:CONFIRMED? Allow them or not? What do to that poll had a winning event or todo.
          </t>
            
          <t>
Need to write down what isn't vaild in a VPOLL.
            <vspace/>
    a. Can't change POLL-MODE

          </t>
            
          <t>
Can a user create a poll with scheduled events where that user's isn't the oranizer of the event? So is there a requirment that the account that poll is on is able to create each on of the resources in the poll? i.e. I can't create a poll with a set of events where I am just the attendee of the events. Are there any other restrictions for components in a VPOLL?
          </t>
            
          <t>
Add a dav property which will specify when a poll will expire and therfore be deleted from the server.
          </t>
            
          <t>
Guide for ATTENDEE roles chair, NON-PARTICIPANT etc
          </t>          
        </list>
      </t>
    </section>
      
    <section title='Security Considerations'>
      <t>
       Applications using these property need to be aware of the risks 
       entailed in using the URIs provided as values. See [RFC3986] for 
       a discussion of the security considerations relating to URIs. 
      </t>
    </section>

    <section anchor="iana_considerations" title='IANA Considerations'>
      <section anchor="parameter_registrations"
               title="Parameter Registrations" >
        <t>
          This document defines the following new iCalendar property parameters
          to be added to the registry defined in Section 8.2.4 of <xref target='RFC5545'/>:
        </t>
        <texttable>
          <ttcol align="left">Property Parameter</ttcol>
          <ttcol align="left">Status</ttcol>
          <ttcol align="left">Reference</ttcol>

          <c>PUBLIC-COMMENT</c>
          <c>Current</c>
          <c>RFCXXXX, <xref target="parameter_public_comment"/></c>

          <c>RESPONSE</c>
          <c>Current</c>
          <c>RFCXXXX, <xref target="parameter_response"/></c>

          <c>STAY-INFORMED</c>
          <c>Current</c>
          <c>RFCXXXX, <xref target="parameter_stayinformed"/></c>
        </texttable>
      </section>
      
      <section anchor="property_registrations"
               title="Property Registrations" >
        <t>
          This document defines the following new iCalendar properties to be
          added to the registry defined in Section 8.2.3 of <xref target='RFC5545'/>:
        </t>
        <texttable>
          <ttcol align="left">Property</ttcol>
          <ttcol align="left">Status</ttcol>
          <ttcol align="left">Reference</ttcol>

          <c>ACCEPT-RESPONSE</c>
          <c>Current</c>
          <c>RFCXXXX, <xref target="accept_response"/></c>

          <c>POLL-ITEM-ID</c>
          <c>Current</c>
          <c>RFCXXXX, <xref target="poll_item_id"/></c>

          <c>POLL-MODE</c>
          <c>Current</c>
          <c>RFCXXXX, <xref target="poll_mode"/></c>

          <c>VOTER</c>
          <c>Current</c>
          <c>RFCXXXX, <xref target="voter"/></c>
        </texttable>
      </section>
    </section>

    <section title="Acknowledgements">
      <t>
        The authors would like to thank the members of the Calendaring and
        Scheduling Consortium Freebusy technical committee and the following
        individuals for contributing their ideas and support:
      </t>
      <t>
        ...
      </t>
      <t>
        The authors would also like to thank the Calendaring and
        Scheduling Consortium for advice with this specification.
      </t>
    </section>
  </middle>

  <!--  *****BACK MATTER ***** -->

  <back>
    <!-- References split into informative and normative -->

    <!-- There are 2 ways to insert reference entries from the citation libraries:
     1. define an ENTITY at the top, and use "ampersand character"RFC2629; here (as shown)
     2. simply use a PI "less than character"?rfc include="reference.RFC.2119.xml"?> here
        (for I-Ds: include="reference.I-D.narten-iana-considerations-rfc2434bis.xml")

     Both are cited textually in the same manner: by using xref elements.
     If you use the PI option, xml2rfc will, by default, try to find included files in the same
     directory as the including file. You can also define the XML_LIBRARY environment variable
     with a value containing a set of directories to search.  These can be either in the local
     filing system or remote ones accessed by http (http://domain/dir/... ).-->

    <references title="Normative References">
      &RFC2119;
      &RFC2434;
      &RFC3688;
      &RFC3986;
      &RFC4589;
      &RFC5545;
      &RFC5546;
      &RFC6047;
      &W3C.REC-xml-20060816;
      &I-D.daboo-icalendar-extensions;
    </references>

    <section title="Open issues">
      <t>
        <list style='hanging'>
          <t hangText="Issue 1:" >
            What's the issue with that?
          </t>
        </list>
      </t>
    </section>
    
    <section title="Change log">
      <t>
        2012-11-02  MD Initial version
      </t>
    </section>
  </back>
</rfc>
